"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * Copyright (c) 2020, salesforce.com, inc.
 * All rights reserved.
 * SPDX-License-Identifier: MIT
 * For full license text, see the LICENSE file in the repo root or https://opensource.org/licenses/MIT
 */
const eslint_1 = require("eslint");
/**
 * Rollup plugin for performing eslint rule validation.
 * This plugin accepts all ESLint CLIEngine config options (https://eslint.org/docs/developer-guide/nodejs-api#cliengine)
 * @param options ESLint CLIEngine Options object
 */
function eslint(options = {}) {
    options.useEslintrc = false;
    const cli = new eslint_1.CLIEngine(options);
    const formatter = cli.getFormatter('unix');
    return {
        name: 'eslint',
        transform(code, id) {
            const report = cli.executeOnText(code, id);
            const result = formatter(report.results);
            if (report.errorCount > 0) {
                throw new Error(result);
            }
        },
    };
}
exports.default = eslint;
//# sourceMappingURL=rollup-plugin-eslint.js.map