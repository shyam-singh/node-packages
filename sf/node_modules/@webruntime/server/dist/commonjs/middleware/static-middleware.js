"use strict";
/** @hidden */
/**
 * Copyright (c) 2019, salesforce.com, inc.
 * All rights reserved.
 * SPDX-License-Identifier: MIT
 * For full license text, see the LICENSE file in the repo root or https://opensource.org/licenses/MIT
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const path_1 = __importDefault(require("path"));
const express_1 = __importDefault(require("express"));
const FRAMEWORK_RESOURCE_JSON = require.resolve('@webruntime/webruntime-shim/dist/resources.json');
const FRAMEWORK_OUTPUT_DIR = path_1.default.dirname(FRAMEWORK_RESOURCE_JSON);
const FRAMEWORK_PUBLIC_DIR = `${FRAMEWORK_OUTPUT_DIR}/public/`;
const STATIC_OPTIONS = {
    index: false,
    immutable: true,
    maxAge: 31536000,
    extensions: ['js'],
};
/**
 * Creates static handlers serving static files including:
 *
 * - Web Runtime framework static files, project static files
 *
 * @public
 */
function createStaticMiddleware(config) {
    const handlers = [];
    const { buildDir } = config;
    // Handle container specific framework resources only if app config exists
    if (config.app) {
        handlers.push(express_1.default.static(FRAMEWORK_PUBLIC_DIR, STATIC_OPTIONS));
    }
    if (buildDir) {
        handlers.push(express_1.default.static(buildDir, STATIC_OPTIONS));
    }
    return handlers;
}
exports.createStaticMiddleware = createStaticMiddleware;
//# sourceMappingURL=static-middleware.js.map